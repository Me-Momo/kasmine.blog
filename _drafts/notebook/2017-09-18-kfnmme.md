---
layout: post
title: 2017-09-18-kfnmme
tags:
---

> 阅读:[【第799期】重新设计 React 组件库](https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&mid=2651224603&idx=1&sn=44301625e46d38125308a30a90f89e42&chksm=bd49a39f8a3e2a899ce36b76dbf516d7e0bc791593c3116ea7bb64fa0951071dc29ed8965edf&scene=21#wechat_redirect)


## 第一个问题：选择开源 vs 造轮子

优秀的开源React UI组件库：material-ui，antd。
**是否开发自有组件判断依据：**
* 产品有独立的设计规范，包括但不限于组件样式、交互模式。
* 产品业务场景较为复杂，需要深度定制某些通用组件。
* 团队需要同时支撑多个相似产品。


🍷 我们团队的实际情况:
TODO:

## 设计思想：规范 vs 自由

* 所谓自由就是: 是否允许组件使用者不被组件所定义好的DOM结构束缚，可以自由的组织自定义元素（通常可通过children属性来实现）


尝试实现以下组件:
* [ ] select元素
* [ ] dropdown元素


* 自由的组件库虽有好处，但是还是有被挑战的问题:就是很难使用，通常组件使用者并不关心内部的实现情况，更在于它的<span style="background-color:#E4F7FF;">**易用性**</span>。复杂过度，还不如自己重新实现一个。

* 规范的组件库可以从根本上保证产品视觉、交互风格的一致性。


### 解决方案：默认值
当用户不指定组成元素时候，选择使用默认组成元素渲染。
* [ ] 如何在规范和自由之间达到一个平衡？


* react-component其实就是非常解耦的设计，几乎没有DOM结构，由使用者自己决定


## 数据处理：耦合 vs 解耦

> 在传统的组件库设计中，我们一直都默认组件是可以和数据源（一般组件都会有 data 这个 prop）相耦合的，这样就导致了我们在给某个组件赋值之前，要先写一个数据处理方法，将后端返回回来的数据处理成组件要求的数据结构，再传给组件进行渲染


### 如何将组件与数据源解耦？

**如何将组件无缝适配于各种各样的后端接口？**

❓ 到此为止，可以发现文章的开发者不仅赋予了使用者自由定制 DOM 结构的能力，同时也赋予了在数据处理上的自由

> **Select（选择器）组件**
> 自由的 Select 需要使用者自定义下拉元素，还需要在回调中自己处理使用 data 的哪个 attribute 来完成下一步的业务逻辑，但 Select 组件真的什么都没有做吗？其实并不是，Select 组件规范了选择这个交互方式，处理了什么时候显示或隐藏下拉列表，添加了下拉列表元素的 hover 和 click 事件，并控制了绝对定位的下拉列表的弹出位置。这些通用的交互逻辑，才是 Select 组件的核心，至于多变的渲染和数据处理逻辑，打包开放给用户反而更利于他们在多变的业务场景中更加方便地使用 Select 组件。



## 回调规范

* css类名规范
  * 不推荐使用 CSS Modules，因为其编译出来的复杂类名不便于使用者在业务项目里进行简单覆盖
  * 参考antd，为每一个组件添加一个名为 `prefixCls` 的 prop，并将其默认值也设置为 `xui-componentName`


* 在回调方面，所有的组件内部函数都以 `handleXXX（handleClick, handleHover, handleMouseover 等）`为命名模板，所有对外暴露的回调函数都以 `onXXX（onChange、onSelect 等）`为命名模板，这样在维护一些依赖层级较深的底层组件时，就可以在 render 方法中一眼看出某个回调是在处理内部状态，还是会抛回到更高一层。




